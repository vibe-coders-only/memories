services:
  memories-sync:
    build: .
    container_name: memories-sync
    restart: unless-stopped
    volumes:
      - ~/.claude/projects:/claude-projects:ro
      - ~/.local/share/memories:/data
    environment:
      - NODE_ENV=production
    command: ["start"]
    ports:
      - "3001:3001"
    
  # Optional: Run one-time sync
  memories-sync-once:
    build: .
    container_name: memories-sync-once
    volumes:
      - ~/.claude/projects:/claude-projects:ro
      - ~/.local/share/memories:/data
    environment:
      - NODE_ENV=production
    command: ["sync"]
    profiles: ["sync-once"]
    
